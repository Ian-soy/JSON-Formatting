<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>历史数据展开/折叠测试</title>
  <link rel="stylesheet" href="src/css/popup.css">
  <style>
    body {
      margin: 20px;
      padding: 20px;
    }
    .test-container {
      width: 800px;
      height: 600px;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      border: 1px solid var(--border-color);
      border-radius: 8px;
    }
    .test-main-content {
      display: flex;
      flex: 1;
      overflow: hidden;
      min-height: 0;
      transition: all 0.3s ease;
    }
    .test-editor-section {
      flex: 1;
      display: flex;
      flex-direction: column;
      min-width: 0;
      background-color: var(--bg-primary);
      padding: 20px;
      transition: all 0.3s ease;
    }
    .demo-info {
      background-color: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 6px;
      padding: 16px;
      margin-bottom: 20px;
      color: var(--text-primary);
    }
    .demo-info h3 {
      color: var(--accent-color);
      margin-bottom: 10px;
    }
    .demo-info ul {
      margin-left: 20px;
      color: var(--text-secondary);
    }
  </style>
</head>
<body>
  <h1>历史数据展开/折叠功能测试</h1>
  
  <div class="demo-info">
    <h3>功能说明：</h3>
    <ul>
      <li>点击历史数据面板左侧中间的小箭头按钮可以展开/折叠历史面板</li>
      <li>折叠时编辑器区域会自动扩展，充分利用屏幕空间</li>
      <li>展开/折叠动画流畅，视觉体验良好</li>
      <li>按钮支持悬停效果和视觉反馈</li>
    </ul>
  </div>
  
  <div class="test-container">
    <div class="test-main-content">
      <!-- 左侧：编辑器区域 -->
      <div class="test-editor-section">
        <h2>编辑器区域</h2>
        <p>这里是JSON编辑器区域，用于展示布局效果。</p>
        <textarea style="width: 100%; height: 200px; background: var(--bg-secondary); color: var(--text-primary); border: 1px solid var(--border-color); border-radius: 4px; padding: 10px;">
{
  "test": "JSON数据",
  "toggle": "展开折叠测试"
}
        </textarea>
      </div>
      
      <!-- 右侧：历史数据面板 -->
      <div class="history-section" id="history-section">
        <!-- 展开/折叠按钮 -->
        <div class="history-toggle-btn" id="history-toggle-btn" title="折叠历史面板">
          <span class="icon-container"></span>
        </div>
        <div class="history-header">
          <h3>历史数据</h3>
          <button id="refresh-history-btn" class="btn secondary"><span class="icon-container"></span></button>
        </div>
        <div class="history-list" id="history-list">
          <div class="history-item">
            <div class="history-item-header">
              <div class="history-item-title">测试数据1</div>
              <div class="history-item-actions">
                <button class="btn danger delete-btn">
                  <span class="icon-container"></span>
                </button>
              </div>
            </div>
            <div class="history-item-info">
              <span class="history-item-date">5分钟前</span>
              <span class="history-item-size">1.2 KB</span>
            </div>
          </div>
          <div class="history-item">
            <div class="history-item-header">
              <div class="history-item-title">测试数据2</div>
              <div class="history-item-actions">
                <button class="btn danger delete-btn">
                  <span class="icon-container"></span>
                </button>
              </div>
            </div>
            <div class="history-item-info">
              <span class="history-item-date">10分钟前</span>
              <span class="history-item-size">2.5 KB</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- 工具模块 -->
  <script src="src/js/icon-manager.js"></script>
  <script>
    // 简化的历史管理器用于测试
    class TestHistoryManager {
      constructor() {
        this.isCollapsed = false;
      }

      initialize() {
        this.setupEventListeners();
        this.initializeToggleButton();
      }

      setupEventListeners() {
        const toggleBtn = document.getElementById('history-toggle-btn');
        if (toggleBtn) {
          toggleBtn.addEventListener('click', () => this.toggleHistoryPanel());
        }

        const refreshBtn = document.getElementById('refresh-history-btn');
        if (refreshBtn) {
          refreshBtn.addEventListener('click', () => this.refreshHistoryList());
        }
      }

      toggleHistoryPanel() {
        const historySection = document.getElementById('history-section');
        const toggleBtn = document.getElementById('history-toggle-btn');
        
        if (!historySection || !toggleBtn) return;

        this.isCollapsed = !this.isCollapsed;
        
        if (this.isCollapsed) {
          // 折叠状态
          historySection.classList.add('collapsed');
          toggleBtn.title = '展开历史面板';
          // 更新图标为向右箭头
          toggleBtn.querySelector('.icon-container').innerHTML = IconManager.getIcon('chevron-right');
        } else {
          // 展开状态
          historySection.classList.remove('collapsed');
          toggleBtn.title = '折叠历史面板';
          // 更新图标为向左箭头
          toggleBtn.querySelector('.icon-container').innerHTML = IconManager.getIcon('chevron-left');
        }
      }

      initializeToggleButton() {
        const toggleBtn = document.getElementById('history-toggle-btn');
        if (toggleBtn) {
          // 默认状态为展开，显示向左箭头（折叠）
          toggleBtn.querySelector('.icon-container').innerHTML = IconManager.getIcon('chevron-left');
        }

        const refreshBtn = document.getElementById('refresh-history-btn');
        if (refreshBtn) {
          refreshBtn.querySelector('.icon-container').innerHTML = IconManager.getIcon('refresh');
        }

        // 初始化删除按钮图标
        const deleteButtons = document.querySelectorAll('.delete-btn .icon-container');
        deleteButtons.forEach(btn => {
          btn.innerHTML = IconManager.getIcon('delete');
        });
      }

      refreshHistoryList() {
        console.log('刷新历史数据列表');
      }
    }

    // 初始化测试
    document.addEventListener('DOMContentLoaded', () => {
      const testManager = new TestHistoryManager();
      testManager.initialize();
    });
  </script>
</body>
</html>